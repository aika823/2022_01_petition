{% extends "base.html" %}

{% block content %}

<!-- section.write -->
<section class="write template">
  <form id="formPetition" action="" method="">

    <div class="form-header">
      <a href="javascript:void(0)"><img src="/static/images/icons/close.png" alt=""></a>
      <h3>ì²­ì› ì‘ì„±</h3>
      <button type="button" class="btn-submit" onclick="loading()">ì™„ë£Œ</button>
    </div>

    {% if petition.thumnail %}
    <div id="thumbnailImage" class="form-row form-row--image"
      style="background-image:url('/media/{{petition.thumbnail}}');">
    </div>
    {% endif %}

    <div class="title-wrap">
      <h2 class="write-title">{{petition.title}}</h2>
      <div class="category-tag">
        <div class="tag">
          <p>ì¹´í…Œê³ ë¦¬</p>
          {% for category in category_list %}
          <p class="category">{{category.name}}</p>
          {% endfor %}
        </div>
        <div class="tag">
          <p>í¬ë§ ìˆ˜ì‹ ì</p>
          <p class="receiver">{{petition.department.name}}</p>
        </div>
      </div>
    </div>

    <div class="line" style="margin-top: 40px;"></div>

    {% if petition.content %}
    <div class="template-form-item">
      <div class="item-title">
        <h3>ğŸ’­ ì²­ì› ë‚´ìš©</h3>
        {% if status.content == 'ì ì ˆ' %}
        <div class="status good"><i class="fas fa-check"></i></div>
        {% else %}
        <div class="status bad"><i class="fas fa-exclamation"></i></div>
        {% endif %}
      </div>
      <p class="item-content">{{petition.content}}</p>
    </div>

    <div class="line"></div>

    {% else %}

    <div class="template-form-item">
      <div class="item-title">
        <h3>ğŸ’­ ì²­ì›ì„ í•˜ê²Œ ëœ ì´ìœ ê°€ ë¬´ì—‡ì¸ê°€ìš”?</h3>
        {% if status.content_1 == 'ì ì ˆ' %}
        <div class="status good"><i class="fas fa-check"></i></div>
        {% else %}
        <div class="status bad"><i class="fas fa-exclamation"></i></div>
        {% endif %}
      </div>
      <p class="item-content">{{petition.content_1}}</p>
    </div>
    <div class="line"></div>

    <div class="template-form-item">
      <div class="item-title">
        <h3>ğŸ“‘ ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” ìë£Œê°€ ìˆë‚˜ìš”?</h3>
        {% if status.content_2 == 'ì ì ˆ' %}
        <div class="status good"><i class="fas fa-check"></i></div>
        {% else %}
        <div class="status bad"><i class="fas fa-exclamation"></i></div>
        {% endif %}
      </div>
      <p class="item-content">{{petition.content_2}}</p>
    </div>
    <div class="line"></div>

    <div class="template-form-item">
      <div class="item-title">
        <h3>âœ¨ ì²­ì›ì´ ì´ë£¨ì–´ì§€ë©´ ì–´ë–¤ íš¨ê³¼ê°€ ìˆì„ê¹Œìš”?</h3>
        {% if status.content_7 == 'ì ì ˆ' %}
        <div class="status good"><i class="fas fa-check"></i></div>
        {% else %}
        <div class="status bad"><i class="fas fa-exclamation"></i></div>
        {% endif %}
      </div>
      <p class="item-content">{{petition.content_7}}</p>
    </div>
    <div class="line"></div>
    {% endif %}

    {% if image_list %}
    <div class="template-form-item">
      <h3>ì´í•´ë¥¼ ë•ê¸° ìœ„í•œ ì‚¬ì§„ ì²¨ë¶€</h3>
      <div id="preview" class="image-wrap">
        {% for image in image_list %}
        <div class="uploaded-img" style="background-image: url('/media/{{image.image}}');"></div>
        {% endfor %}
      </div>
    </div>
    <div class="line"></div>
    {% endif %}

    {% if has_keyword %}
    <div class="template-form-item">
      <h3>ğŸ”– í•µì‹¬ ë‹¨ì–´ ì„¸ ê°€ì§€</h3>
      <p>ë‹¤ë¥¸ ì‹œë¯¼ë“¤ì´ ì´ ì²­ì›ì„ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ìš”</p>
      <div class="tag-keywords">
        {% if petition.keyword_1 %}
        <p class="keyword done"># <span>{{petition.keyword_1}}</span></p>
        {% endif %}
        {% if petition.keyword_2 %}
        <p class="keyword done"># <span>{{petition.keyword_2}}</span></p>
        {% endif %}
        {% if petition.keyword_3 %}
        <p class="keyword done"># <span>{{petition.keyword_3}}</span></p>
        {% endif %}
      </div>
    </div>
    {% endif %}
    
    <div class="edit-tools">
      <a href="javascript:void(0)">
        <span class="material-icons-outlined">title</span>
      </a>
      <a href="javascript:void(0)">
        <span class="material-icons-outlined">keyboard_voice</span>
      </a>
      <a class="blue" href="javascript:void(0)">
        <span class="material-icons-outlined">add</span>
      </a>
    </div>

  </form>

  <section class="inspection">
    <div class="slide-inspection">
      <div class="inspection-box">
        <div class="result-text">
          <div class="status"><i class="fas fa-exclamation"></i></div>
          <p>ë¶„ì„ê²°ê³¼</p>
        </div>
        <h3 class="mention"><span>ì ì ˆí•œ</span> í‘œí˜„ì…ë‹ˆë‹¤.</h3>
        <div class="box-bottom">
          <p class="comment">
            ì•ìœ¼ë¡œë„ íƒ€ ì‹œë¯¼ì„ ë°°ë ¤í•˜ëŠ” ë§ë“¤ë¡œ
            <br>ìˆ™ì˜ì  ì²­ì›ì˜ í™˜ê²½ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”.
          </p>
          <a href="javascript:void(0)" class="btn-apply" onclick="$('.slick-next').trigger('click');">
            í™•ì¸
          </a>
        </div>
        <p class="btn-close"><i class="fas fa-times"></i></p>
      </div>

      <div class="inspection-box">
        <div class="result-text">
          <div class="status"><i class="fas fa-exclamation"></i></div>
          <p>ë¶„ì„ê²°ê³¼</p>
        </div>
        <h3>ëª¨ë¸ì´ <span>ì œëŒ€ë¡œ ì²˜ë¦¬</span>í–ˆë‚˜ìš”?</h3>
        <div class="box-bottom box-bottom--grid">
          <a class="btn-apply done" href="javascript:void(0)">ë„¤</a>
          <a class="btn-apply done" href="javascript:void(0)">ì•„ë‹ˆìš”</a>
        </div>
        <p class="btn-close"><i class="fas fa-times"></i></p>
      </div>
    </div>
  </section>

  <div class="loading-motion">
    <img src="/static/gif_files/load.gif" alt="">
    <h3>ì²­ì›ì„ ì €ì¥í•˜ê³  ìˆì–´ìš”</h3>
    <p>ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”</p>
  </div>

  <div class="finish-write">
    <h2>ì²­ì› ì™„ë£Œ</h2>
    <h3>ì†Œì¤‘í•œ ì²­ì› ê°ì‚¬í•©ë‹ˆë‹¤</h3>
    <p>20ë§Œëª…ì˜ ì„œëª…ì„ ëª¨ì•„ì£¼ì„¸ìš”</p>
  </div>

</section>

<section class="modal_wrap">
  <article class="modal_cnt">
    <div class="modal_body">
      <h4>
        ë¶€ì ì ˆ í‘œí˜„ ê°ì§€
        <br>AI ë¶„ì„ ì¤‘...
      </h4>
      <div class="img-wrap">
        <img src="/static/gif_files/load.gif" alt="">
      </div>
    </div>
    <a href="javascript:void(0)" class="close_btn">ë‹«ê¸°</a>
  </article>
  <div class="modal_dim"></div>
</section>
{% endblock content %}


{% block extrascripts %}
<script type="text/javascript" src="/static/slick/slick.min.js"></script>

<script>
  $('.slide-inspection').slick({
    infinite: true,
    slidesToShow: 1,
    slidesToScroll: 1,
    autoplay: false,
  })
</script>

<script>
  $('#title').click(function () {
    $('.line').animate({
      "width": "100%"
    }, 400)
  });
</script>

<script>
  $('.status').click(function () {
    $('section.inspection').css({
      'bottom': '-300px'
    });
    if ($(this).hasClass('good') == true) {
      $('.mention').html(`
        <span>ì ì ˆí•œ</span> í‘œí˜„ì…ë‹ˆë‹¤.
      `);
      $('.inspection-box').removeClass('good');
      $('.inspection-box').removeClass('bad');
      $('.inspection-box').addClass('good');
    } else {
      $('.mention').html(`
        <span>ë¶€ì ì ˆ í‘œí˜„</span>ì´ <br>ì¸ì‹ë˜ì—ˆìŠµë‹ˆë‹¤.
      `);
      $('.inspection-box').removeClass('good');
      $('.inspection-box').removeClass('bad');
      $('.inspection-box').addClass('bad');
    }
    $('section.inspection').animate({
      'bottom': '10px'
    }, 300);
  });

  $('.btn-close').click(function () {
    $('section.inspection').animate({
      'bottom': '-300px'
    }, 300);
  });

  $('.btn-close').click(function () {
    $('section.inspection').animate({
      'bottom': '-300px'
    }, 300);
  });
  $('.done').click(function () {
    $('section.inspection').animate({
      'bottom': '-300px'
    }, 300);
  });
</script>

<script>
  function loading() {
    $('.loading-motion').fadeIn(300);
    $('.loading-motion').css('display', 'flex');

    setTimeout(() => {
      $('.loading-motion').fadeOut(300);
      $('.finish-write').css('display', 'flex');
    }, 1500);

    $('.finish-write').click(function () {
      location.href = '/detail/{{petition.id}}';
    });
  }
</script>

<script>
  function getScrollWidth() {
    var body = document.querySelector('body');
    var scrollDiv = document.createElement('div');
    scrollDiv.className = 'fake_sjwidth';
    body.appendChild(scrollDiv);
    var scrollbarWidth = $(document).height() > $(window).height() ? scrollDiv.offsetWidth - scrollDiv.clientWidth :
      0;

    body.removeChild(scrollDiv);
    return scrollbarWidth;
  }
</script>
{% endblock extrascripts %}